<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .br {
            display: block;
            margin-bottom: 0.4em;
        }
    </style>
</head>
<body>
<div class="br">Enter password:</div>
<form id="form">
    <input type="password" id="password"/>
    <button type="submit">Submit</button>
</form>

<script>

    document.getElementById('form').addEventListener('submit', function(event) {
        event.preventDefault();
        const password = document.getElementById('password').value;
        digestMessage(password).then(hash => document.write(int_to_string(extend(hash) ^ xor_key)));
    });

    async function digestMessage(message) {
        const msgUint8 = new TextEncoder().encode(message); // encode as (utf-8) Uint8Array
        const hashBuffer = await crypto.subtle.digest("SHA-256", msgUint8); // hash the message
        const hashArray = Array.from(new Uint8Array(hashBuffer)); // convert buffer to byte array
        const hash = hashArray
            .map((b) => b.toString(16).padStart(2, "0"))
            .join(""); // convert bytes to hex string
        h = BigInt('0x' + hash);
        console.log(h)
        return h;
    }

    function log(n) {
        return BigInt(n.toString(2).length);
    }

    function extend(hash) {
        const code_len = 9646n;
        const repeat = code_len / log(hash) + 1n;
        let b = 0n;
        for (let i = 0n; i < repeat; i++) {
            b += hash * 2n**(i * log(hash));
        }
        b %= 2n ** code_len;
        return b;
    }

    function int_to_string(n){
        const bytes = [];
        for (let i = (log(n) + 7n) / 8n - 1n; i >= 0; i--) {
            bytes.push(String.fromCharCode(Number(n / 256n**i % 256n)));
        }
        return bytes.join('');
    }

    const xor_key = 296234754753848985715992282504624912903663334663554320207040516182753444608599862417238697144631666244162719661740672472050846247648336368040651659619486328480737114876028282971614924843279893604439221927481730147063899592406850478982550662452677837129716623376388015027826550558008712661895714296680478546115075494066328977730641386492243276155000720970401880944015014600647284397332211352931108670225949559487422699102194824529696155149487439720097590200570431382892297375154674913771840489081179222557215484958045266051658928234247756999004358144086188674866053590922257105804665500868917091728726623061249608499422796623524918135446594638771428177814052063238574364920577388180865874175921652158952711415288727422925552027595081324631378959993738565289103554856946845160474533461523170786621069406494065094580614675638814495875623499132970045145486315200394689106350267454478573352006681529650349411132787406129858916363929079737500565992128905792099977908688810786176768107844803568475157026637010894688272641025560256740427106123417675100621708414493192551957358283084494995684658374450237255704764040010415400932858052813150181569596788022062301697785933274470412137923131434958284921326242412179007552794031917656184215728462548344543805590930061523084485416297035439508958326947787474473498461699427967188304301542611971247387966553058286684790393192234203886110994431213082925718484675921248254809884693317411611339805053346629611365488087515939186390559218655469566343616695054505665955028544880801593673971879480041026264938028587313610323703270989038722186776692385371409033027040726203835369849098235925788214244452574455912757174568950821884163660714000936806562261379293688686958433329251126767069994720781291790722465599027639537387140298492182251871752487694136667990343652915584088550585004707752560406802356835369900051163005068253108499778571145747001307034204514378998337085503546798986007685297353327007147467163160816401797331596592888155714759368260261850087489777403061212301872174472418877241819665917059340953474579250820715315902165305378497828567347223239475877647121388670233268514834708674663979153298973008477700878528042377757941085110481761947127312995295528688671093481319900016379623399940278847460400719993352976580686689260581354539171491341642474465220342807223102733040161808438370155752069370809072064411163970835122486138484960460709789034826425675426553516489952039631690635022760703223067687989232619924523654265156801044618462666952983440359038637493102741029060351239737196662105962896623393246823373280785036249372834354913649573867291904751432988014787713929675652844420030711071609312450047596678900136402890704084964562597290052063300370872662804309182389634951637422454225052801319441588071670177700158817028510817518575323404141858709649826992590943939728941660000643259677163015455917394790229582257127312059199086535980957401359498325346378418584458n
</script>

</body>
</html>